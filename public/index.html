<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ìš°ë¦¬ê°€ ìš°ì—°íˆ ì‚´ì•„ë‚¨ì€ 1ë…„ ê·¸ ì´í›„</title>
    <meta property="og:url"                content="https://remember-160517.com/" />
    <meta property="og:type"               content="website" />
    <meta property="og:title"              content="ìš°ë¦¬ê°€ ìš°ì—°íˆ ì‚´ì•„ë‚¨ì€ 1ë…„ ê·¸ ì´í›„" />
    <meta property="og:description"        content="16ë…„ 5ì›” 17ì¼ ê°•ë‚¨ì—­ ì—¬ì„±ì‚´í•´ì‚¬ê±´ 1ì£¼ê¸°ë¥¼ ì¶”ëª¨í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤" />
    <meta property="og:image"              content="https://pbs.twimg.com/profile_images/835431700448452608/KnAWOGgR.jpg" />
    <meta property="fb:app_id" content="1409770342400157" />


    <!-- https://goo.gl/FY4AYK -->

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/3.9.0/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/3.9.0/firebase-auth.js"></script>
    <script defer src="/__/firebase/3.9.0/firebase-database.js"></script>
    <script defer src="/__/firebase/3.9.0/firebase-messaging.js"></script>
    <script defer src="/__/firebase/3.9.0/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>

    <script
      src="https://code.jquery.com/jquery-3.2.1.min.js"
      integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
      crossorigin="anonymous"></script>

    <script src="https://unpkg.com/vue"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <style media="screen">
      body { background: #fcfcfc; color: rgba(0,0,0,0.87); font-family: Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
      #top-back {
        height: 450px;
        position: relative;
        background-color: #363a3c;
        left: 0px;
        top: 0px;
        width: 100%;
      }
      #main-contents {
        position: relative;
        top: -450px;
      }
      #ribbon { 
        max-width: 720px; 
        margin: 120px auto 50px;
        padding: 40px 24px; 
        background: url("./image/ribbon.png") no-repeat center;
      }
      #comment { 
        background: white; 
        max-width: 720px; 
        margin: 0px auto 16px;
        padding: 50px; 
        border-radius: 0px; 
        color: #363a3c;
      }
      #comment h2 { color: #ffa100; font-weight: bold; font-size: 16px; margin: 0 0 8px; }
      #comment h1 { 
        font-size: 32px; 
        font-weight: 900; 
        color: #363a3c; 
        margin: 0 0 16px;
        letter-spacing: -2px
      }
      #comment .pin {
        width: 20px;
        margin-right: 10px;
      }
      #comment p { 
        line-height: 26px; 
        margin: 16px 0 24px; 
        font-size: 14px; 
      }
      #comment a.comment-submit-btn{ display: block; text-align: center; background: #363a3c; text-transform: uppercase; text-decoration: none; color: white; padding: 16px; border-radius: 0px; }
      #comment { 
        /*box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); */
        box-shadow: 0 20px 20px rgba(0,0,0,.1);
      }
      #comment p.addition-text {
        font-size:12px;
        line-height: 22px;
      }
      .before-login, .after-login {
        margin-left: auto;
      }
      .before-login .facebook-login-button {
        background-color: rgb(59, 89, 152);
        color: white;
      }
      .before-login .twitter-login-button {
        background-color: rgb(51, 204, 255);
        color: white;
      }
      #load { color: rgba(0,0,0,0.4); text-align: center; font-size: 13px; }
      @media (max-width: 600px) {
        body, #comment { margin-top: 0; background: white; box-shadow: none; }
      }
      
      #top-nav { 
        display: flex;
        max-width: 720px; 
        margin: 12px auto 12px; 
        padding: 0px 0px;
      }
      #top-nav .user-image { width: 30px; }
      #top-nav .after-login {
        -webkit-transform-style: preserve-3d;
        -moz-transform-style: preserve-3d;
        transform-style: preserve-3d;
      }
      #top-nav .after-login .user-name {
        position: relative;
        top: 50%;
        transform: translateY(-50%);
        padding-right: 20px;
        color: #fcfcfc;
      }
      #top-nav .after-login .float {
        float: left;
      }
      #top-nav .after-login .logout-button { 
        background-color: #fcfcfc;
        border-color: #999999;
      }
      #comment-lists { 
        column-width: 250px;
        column-gap: 15px;
        width: 90%;
        max-width: 1100px;
        margin: 50px auto;
      }
      @font-face {
        font-family: SDMiSaeng;
        src: url(font/SDMiSaeng.ttf);
      }
      #comment-lists li { 
        background:#ffc; 
        /*border: 2px solid #ffc;*/
        /*box-shadow: 0 1px 2px rgba(34, 25, 25, 0.4);*/
        box-shadow: 0 10px 10px rgba(0,0,0,.1);
        margin: 25px 2px 25px;
        padding: 15px;
        padding-bottom: 10px;
        transition: opacity .4s ease-in-out;
        display: inline-block;
        column-break-inside: avoid;
        min-width: 110px;
      }
      @media (max-width: 600px) {
        #comment-lists li { 
          margin:-3px;
        }
      }

      #comment-lists li .comment-div {
        position: relative;
        height: 100%;
        text-align: left;
      }

      #comment-lists li a {
        color: #666666;
      }
      
      #comment-lists li .data-comment {
        word-break: break-all;
        font-family: SDMiSaeng;
        font-size: 20px;
        margin-bottom: 63px;
      }
      #comment-lists li:nth-child(even){
        -o-transform:rotate(4deg);
        -webkit-transform:rotate(4deg);
        -moz-transform:rotate(4deg);
        position:relative;
        top:5px;
        background:#cfc;
      }
      #comment-lists li:nth-child(3n){
        -o-transform:rotate(-3deg);
        -webkit-transform:rotate(-3deg);
        -moz-transform:rotate(-3deg);
        position:relative;
        top:-5px;
        background:#ccf;
      }

/*      #comment-lists li:hover,#comment-lists li:focus{
        -moz-box-shadow:10px 10px 7px rgba(0,0,0,.7);
        -webkit-box-shadow: 10px 10px 7px rgba(0,0,0,.7);
        box-shadow:10px 10px 7px rgba(0,0,0,.7);
        -webkit-transform: scale(1.25);
        -moz-transform: scale(1.25);
        -o-transform: scale(1.25);
        position:relative;
        z-index:5;
      } */

      #comment-lists li .data-datetime {
        position: absolute;
        bottom: 0; 
        width: 100%; 
        height: 51px; 
        font-size: 10px
      }
      #comment-lists li .data-share {
        position: absolute;
        bottom: 0; 
        width: 100%; 
        height: 31px; 
      }
      #comment-lists li .share-btn-item {
        margin-left: -13px;
        float: right;
      }
      
      #comment-lists img { width: 50px; }
      #more { 
        max-width: 720px; 
        margin: 12px auto 12px;
        padding: 0px 50px; 
      }
      #more a{ 
        display: block; 
        text-align: center; 
        background: white; 
        text-transform: uppercase; 
        text-decoration: none; 
        color: #363a3c; 
        border-color: #363a3c;
        padding: 16px; 
        border-radius: 0px; 
      }

      .submit-result {
        text-align: center;
        margin-bottom: 16px;
        padding: 16px 10px;
        color: rgb(60, 118, 61);
        background-color: rgb(223, 240, 216);
      }
      .submit-result-fail {
        text-align: center;
        margin-bottom: 16px;
        padding: 16px 10px;
        color: rgb(169, 68, 66);
        background-color: rgb(242, 222, 222);
      }
    </style>
  </head>
  <body>
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '1409770342400157',
          xfbml      : true,
          version    : 'v2.9'
        });
        FB.AppEvents.logPageView();
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "//connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>
    <div id="top-back">
    </div>
    <div id="main-contents">
      <div id="top-nav">
        <div v-if="fbuser != null" class="after-login">
          <div class="user-name float">{{ fbuser.displayName }} ë‹˜</div>
  <!--         <div class="float">
            <img v-bind:src="fbuser.photoURL" class="user-image"></img>
          </div> -->
          <div class="float">
            <button class="logout-button btn" v-on:click="logout()"> logout</button>
          </div>
        </div>
        <div v-else class="before-login">
          <button class="facebook-login-button btn float" v-on:click="loginFacebook()">
            <i class="fa fa-facebook-official" aria-hidden="true"></i> facebook ë¡œê·¸ì¸
          </button>
          <button class="twitter-login-button btn" v-on:click="loginTwitter()">
            <i class="fa fa-twitter" aria-hidden="true"></i> twitter ë¡œê·¸ì¸
          </button>
        </div>
      </div>
      <div id="ribbon">

      </div>
      <div id="comment">
        <!-- <h2>í…Œí¬í˜ë¯¸</h2> -->
        <h1><strong>ìš°ë¦¬ê°€ ìš°ì—°íˆ ì‚´ì•„ë‚¨ì€ 1ë…„ ê·¸ ì´í›„</strong></h1>
        <p>
        ê°•ë‚¨ì—­ ì—¬ì„±ì‚´í•´ì‚¬ê±´ ì´í›„ 1ë…„ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤. <br>
        ë‹¹ì‹œ ê°•ë‚¨ì—­ 10ë²ˆ ì¶œêµ¬ ì¸ê·¼ì—ì„œëŠ” ë§ì€ ì‚¬ëŒì´ ìµëª…ìœ¼ë¡œ í¬ìŠ¤íŠ¸ì‡ì„ ì‘ì„±í•˜ì—¬ ì  ë”í­ë ¥ì— ëŒ€í•œ ìì‹ ì˜ ê²½í—˜ì„ ì „í–ˆìŠµë‹ˆë‹¤. 
        ìš°ë¦¬ëŠ” ì„œë¡œì˜ ê²½í—˜ì— ê³µê°í•˜ê¸°ë„ í•˜ê³  í•¨ê»˜ ë¶„ë…¸í•˜ê¸°ë„ í–ˆìœ¼ë©° ì´ë¥¼ ê³„ê¸°ë¡œ í˜ë¯¸ë‹ˆìŠ¤íŠ¸ë¡œì„œì˜ ìì‹ ì„ ë°œê²¬í•˜ê¸°ë„ í–ˆìŠµë‹ˆë‹¤.
        <a href="https://twitter.com/techfemi" target="_blank">í…Œí¬í˜ë¯¸</a>ëŠ” ë‹¤ì‹œê¸ˆ ì¶”ëª¨ì˜ ì‹œê°„ì„ ê°€ì§€ê³  ì‚¬ê±´ ì´í›„ ìš°ë¦¬ ëª¨ë‘ ì–´ë–»ê²Œ 'ì‚´ì•„ ë‚¨ì•˜ëŠ”ì§€' ì— ëŒ€í•´ ì´ì•¼ê¸° í•˜ê³ ì ê³µê°„ì„ ë§Œë“¤ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
        ë¬¸ì œê°€ ìˆê±°ë‚˜ ê¶ê¸ˆí•˜ì‹  ì ì€ <a href="mailto:techfemi.kr@gmail.com">techfemi.kr@gmail.com</a>ìœ¼ë¡œ ë¬¸ì˜ ë°”ëë‹ˆë‹¤.<br>

        </p>
        <p class="addition-text">
        <strong>
        <img class="pin" src="https://abs.twimg.com/emoji/v1/72x72/1f4cc.png">ì•Œë ¤ë“œë¦½ë‹ˆë‹¤<br>
      
        </strong>
        <strong>1. ê²Œì‹œë¬¼ ê´€ë¦¬ì •ì±…</strong><br>
        ì¥ì• , ì„±ë³„, êµ­ì , ì¸ì¢…ì´ë‚˜ ë¯¼ì¡±, ì¢…êµ, ì„±ì  ì§€í–¥ì— ëŒ€í•œ ë¹„ë°© ë° í˜ì˜¤ì™€ ìš•ì„¤ì„ í¬í•¨í•¨ ë©”ì„¸ì§€ëŠ” <br>ê´€ë¦¬ìì— ì˜í•´ ì„ì˜ë¡œ ì‚­ì œë©ë‹ˆë‹¤. <br>
        í•´ë‹¹ ë©”ì„¸ì§€ì˜ ì‘ì„±ìëŠ” í–¥í›„ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•  ìˆ˜ ì—†ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.<br>
        <strong>2. ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</strong><br>
        ì¶”ëª¨ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•˜ì‹œë©´ ì•„ë˜ ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•˜ì‹  ê²ƒìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.<br>
         - ê°œì¸ì •ë³´ ìˆ˜ì§‘í•­ëª©<br>
            [í˜ì´ìŠ¤ë¶ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹œ] ì´ë©”ì¼, ì´ë¦„, ì„œë¹„ìŠ¤ ì´ìš©ê¸°ë¡(ë°©ë¬¸ì¼ì‹œ)<br>
            [íŠ¸ìœ„í„°ë¡œ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹œ] ì´ë©”ì¼, ë‹‰ë„¤ì„, ì„œë¹„ìŠ¤ ì´ìš©ê¸°ë¡(ë°©ë¬¸ì¼ì‹œ)<br>
         - ê°œì¸ì •ë³´ ìˆ˜ì§‘ëª©ì : ë¡œê·¸ì¸ ê¸°ë°˜ ë©”ì„¸ì§€ ì‘ì„± ì„œë¹„ìŠ¤ ì œê³µ ë° ê³ ê°ëŒ€ì‘<br>
         - ê°œì¸ì •ë³´ ë³´ìœ  ë° ì´ìš©ê¸°ê°„: ëª©ì  ë‹¬ì„± í›„ ì§€ì²´ì—†ì´ íŒŒê¸°<br>
        <br>
        </p>
        <input type="text" class="input-comment form-control" maxlength="140">
        <hr>
        <div>
          <div class="submit-result" style="opacity: -0.1; display: none;">
            ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤
          </div>
          <div class="submit-result-fail" style="opacity: -0.1; display: none;">
            <button type="button" class="close" onclick="hideMessage()" aria-label="Close">
                <span aria-hidden="true">Ã—</span>
            </button>
            <span class="result-fail-message"></span>
          </div>
        </div>
        <a href="" class="comment-submit-btn btn btn-large">ì „ì†¡</a>
      </div>
      <div id="">
        <ul id="comment-lists">
          <li v-for="data in datas">
            <div class="comment-div">
              <div class="data-comment">{{ data.comment }}
              </div>
              <div class="data-datetime">
                {{ data.datetime }}
              </div>
              <div class="data-share">
                <div v-if="fbuser != null && fbuser.uid == data.uid" class="delete-btn share-btn-item" style="float: left;">
                  <a class="comment-delete-button btn" v-on:click="deleteComment(data.key)">
                    <i class="fa fa-trash-o" aria-hidden="true"></i>
                  </a>
                </div>
                <div class="share-btn-item">
                  <a class="facebook-share-button btn" v-on:click="shareFacebook(data.comment)">
                    <i class="fa fa-facebook-official" aria-hidden="true"></i>
                  </a>
                </div>
                <div class="share-btn-item">
                  <a class="twitter-share-button btn" v-bind:href="'http://twitter.com/share?url=https://remember-160517.com/&text='+data.comment" target="_blank">
                    <i class="fa fa-twitter" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
          </li>
        </ul>
      </div>
      <div id="more">
        <a href="" class="more-btn btn btn-large">ë”ë³´ê¸°</a>
      </div>
    </div>

    <script>
      const requestCount = 15;
      let datas = [];
      let blockUsers = [];
      let fbuser = null;
      let vue1, vue2;

      document.addEventListener('DOMContentLoaded', function() {
        // // ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        // firebase.database().ref('/path/to/ref').on('data', snapshot => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
        //
        // // ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

        try {
          let app = firebase.app();
          let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
          //document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          //document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
        }
        
        // document.getElementsByClassName('twitter-login-button')[0].addEventListener('click', function(event) {
        //   event.preventDefault();
        //   console.log('click twitter-login-button');
        //   loginTwitter();
        // });
   
        // document.getElementsByClassName('logout-button')[0].addEventListener('click', function(event) {
        //   event.preventDefault();
        //   console.log('click logout-button');
        //   logout();
        // });

        // document.getElementsByClassName('facebook-login-button')[0].addEventListener('click', function(event) {
        //   event.preventDefault();
        //   console.log('click facebook-login-button');
        //   loginFacebook();
        // });

        document.getElementsByClassName('comment-submit-btn')[0].addEventListener('click', function(event) {
          event.preventDefault();
          console.log('click comment-submit-btn');
          submitComment();
        });

        document.getElementsByClassName('more-btn')[0].addEventListener('click', function(event) {
          event.preventDefault();
          console.log('click more-btn');
          requestComments();
        });

        document.getElementsByClassName('more-btn')[0].addEventListener('click', function(event) {
          event.preventDefault();
          console.log('click more-btn');
          requestComments();
        });

        firebase.auth().onAuthStateChanged(function(auth) {
          vue1.fbuser = auth;
          vue2.fbuser = auth;
          // console.log(fbuser);
        });

        vue1 = new Vue({
          el: '#comment-lists',
          data: {
            fbuser: fbuser,
            datas: datas
          },
          methods: {
            shareFacebook: function(message) {
              shareFacebook(message);
            },
            deleteComment: function(key) {
              deleteComment(key);
            }
          }
        });

        vue2 = new Vue({
          el: '#top-nav',
          data: {
            fbuser: fbuser
          },
          methods: {
            logout: function() {
              requestLogout();
            },
            loginTwitter: function() {
              loginTwitter();
            },
            loginFacebook: function() {
              loginFacebook();
            }
          }
        })

        requestComments();

        firebase.database().ref().child('comments').orderByKey().limitToLast(requestCount).on('child_added',
          function(data) {
            let val = data.val();
            val['key'] = data.key;
            if ( datas.findIndex(x => x.key == data.key) == -1) {
              datas.unshift(val);
            }
          }
        );
        firebase.database().ref().child('comments').orderByKey().limitToLast(requestCount).on('child_changed',
          function(data) {
            let val = data.val();
            let index = datas.findIndex(x => x.key == data.key);
            if (index != -1) {
              datas[index]['datetime'] = val.datetime;
            }
            vue1.$forceUpdate();
          }
        );
        firebase.database().ref().child('comments').orderByKey().limitToLast(requestCount).on('child_removed',
          function(data) {
            let index = datas.findIndex(x => x.key == data.key);
            if (index != -1) {
              datas.splice(index, 1);
            }
          }
        );
        firebase.database().ref().child('blockUsers').on('child_added',
          function(data) {
            blockUsers.push(data.key);
          }
        );
      }); 

      function deleteComment(key) {
        // let index = datas.findIndex(x => x.key == key);
        // if (index != -1) {        
        // }

        let ref = firebase.database().ref().child('comments').child(key);
        ref.remove().then(function() {
          console.log("Remove succeeded.")
        });
      }

      function shareFacebook(message) {
        FB.ui({
          method: 'share',
          display: 'popup',
          href: 'https://remember-160517.com/',
          hashtag: '#í…Œí¬í˜ë¯¸ë¥¼_ë§Œë‚˜ê³ _ë‚˜ì˜_ì„±ê³µì‹œëŒ€_ì‹œì‘ëë‹¤',
          quote: message,

        }, function(response){});
      }

      function requestComments() {
        let count = datas.length;
        if (count > 0) {
          let lastKey = datas[count-1].key;
          // let firstKey = datas[0].key;

          firebase.database().ref().child('comments').orderByKey().endAt(lastKey).limitToLast(requestCount+1).once('value').then(
            function(snapshot) {
              processSnapshot(snapshot);
            }
          );  
        } else {
          firebase.database().ref().child('comments').orderByKey().limitToLast(requestCount).once('value').then(
            function(snapshot) {
              processSnapshot(snapshot);            
            }
          );
        }
      }

      function processSnapshot(snapshot) {
        newDatas = [];
        snapshot.forEach(function(childSnapshot) {
          let val = childSnapshot.val();
          val['key'] = childSnapshot.key;
          val['datetime'] = childSnapshot.datetime;
          // console.log(val);
          if ( datas.findIndex(x => x.key == childSnapshot.key) == -1) {
            newDatas.push(val);
          }
        });
        newDatas.reverse();
        newDatas.forEach(function(val) {
          datas.push(val);
        });
      }

      function submitComment() {
        let user = firebase.auth().currentUser;
        if (user == null) {
          showMessage("ë¡œê·¸ì¸ì„ í•˜ì‹œë©´ ì¶”ëª¨ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
          return;
        }

        document.getElementsByClassName('comment-submit-btn')[0].disabled = true;
        let comment = document.getElementsByClassName('input-comment')[0].value;

        if (comment.trim() == '') {
          showMessage("ì¶”ëª¨ ë©”ì„¸ì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }

        let len = comment.length;
        if (len > 140) {
          showMessage("ì¶”ëª¨ ë©”ì„¸ì§€ëŠ” 140ì ë¯¸ë§Œìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.");
          return;  
        }

        // 12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
        // í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­í•œë‘˜ì…‹ë„·ë‹¤ì—¬ì¹ íŒ”êµ¬ì‹­
        let uid = user.uid;
        if (blockUsers.findIndex(x => x == uid) != -1) {
          showMessage("ì¶”ëª¨ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìì„¸í•œ ì‚¬í•­ì€ ì•„ë˜ ë©”ì¼ë¡œ ë¬¸ì˜ë°”ëë‹ˆë‹¤.");
          return;  
        }
          
        // console.log(comment);
        let object = {
          uid : user.uid,
          username : user.displayName,
          userPhotoUrl : user.photoURL,
          comment : comment,
        };

        // Get a key for a new Post.
        var newPostKey = firebase.database().ref().child('comments').push().key;

        var updates = {};
        updates['/comments/' + newPostKey] = object;

        firebase.database().ref().update(updates, function() {
          document.getElementsByClassName('comment-submit-btn')[0].disabled = false;
          document.getElementsByClassName('input-comment')[0].value = '';

          showMessage("ì¶”ëª¨ ë©”ì„¸ì§€ê°€ ë“±ë¡ ë˜ì—ˆìŠµë‹ˆë‹¤.", true);
        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...

          showMessage("ì¶”ëª¨ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.  ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì‹œê±°ë‚˜ ë©”ì¼ë¡œ ë¬¸ì˜ ë°”ëë‹ˆë‹¤.");
        });;
      }

      function requestLogout() {
        firebase.auth().signOut();
      }

      function loginFacebook() {
        var provider = new firebase.auth.FacebookAuthProvider();
        provider.addScope('user_birthday');
        provider.setCustomParameters({
          'display': 'popup'
        });

        firebase.auth().signInWithPopup(provider).then(function(result) {
          // This gives you a Facebook Access Token. You can use it to access the Facebook API.
          var token = result.credential.accessToken;
          // The signed-in user info.
          var user = result.user;
          // ...
          console.log('success');

        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...

          console.log('error');
          showMessage("ë¡œê·¸ì¸ì„ í•  ìˆ˜ ì—†ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì‹œê±°ë‚˜ ë©”ì¼ë¡œ ë¬¸ì˜ ë°”ëë‹ˆë‹¤.");
        });
      }

      function loginTwitter() {
        var provider = new firebase.auth.TwitterAuthProvider();
        provider.setCustomParameters({
          'lang': 'kr'
        });

        firebase.auth().signInWithPopup(provider).then(function(result) {
          // This gives you a the Twitter OAuth 1.0 Access Token and Secret.
          // You can use these server side with your app's credentials to access the Twitter API.
          var token = result.credential.accessToken;
          var secret = result.credential.secret;
          // The signed-in user info.
          var user = result.user;
          // ...
          console.log('twitter success');

        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...
          console.log('twitter error');
          showMessage("ë¡œê·¸ì¸ì„ í•  ìˆ˜ ì—†ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì‹œê±°ë‚˜ ë©”ì¼ë¡œ ë¬¸ì˜ ë°”ëë‹ˆë‹¤.");
        });
        //*/
      }

      function showMessage(message, autoHide = false) {
        if (autoHide) {
          hideMessage();
          var result = document.getElementsByClassName('submit-result')[0];
          result.innerHTML = message;
          fadeIn(result);
          setTimeout(function() {
            fadeOut(result);
          }, 1300);
        }
        else {
          var result = document.getElementsByClassName('submit-result-fail')[0];
          var messageDiv = document.getElementsByClassName('result-fail-message')[0];
          messageDiv.innerHTML = message;
          fadeIn(result);
        }
      }

      function hideMessage() {
        var result = document.getElementsByClassName('submit-result-fail')[0];
        fadeOut(result);
      }

      // fade out
      function fadeOut(el) {
        var op = 1;
        var timer = setInterval(function () {
          if (op <= 0.1){
            clearInterval(timer);
            el.style.display = 'none';
          }
          el.style.opacity = op;
          op -= op * 0.1;
        }, 10);
      }

      // fade in
      function fadeIn(el) {
        var op = 0;
        el.style.opacity = op;
        el.style.display = '';
        
        var timer = setInterval(function () {
          if (op >= 1.0){
            clearInterval(timer);
          }
          el.style.opacity = op;
          op = op + 0.1;
        }, 30);
      }

    </script>
  </body>
</html>
